<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kursion</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --bg: #000;
      --bg-secondary-opaque: #111;
      --bg-secondary-translucent: rgba(17, 17, 17, 0.5);
      --text-primary: #fff;
      --text-secondary: #888;
      --border: #333;
      --accent: #0070f3;
      --accent-glow: rgba(0, 112, 243, 0.3);
      --brand-green: #3fb950;
      --error-red: #f85149;
    }

    body.light {
      --bg: #f9f9f9;
      --bg-secondary-opaque: #fff;
      --bg-secondary-translucent: rgba(255, 255, 255, 0.6);
      --text-primary: #000;
      --text-secondary: #666;
      --border: #eaeaea;
    }

    /* Initial state is theme-aware */
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-secondary-opaque);
      color: var(--text-primary);
      transition: background-color 0.5s ease;
    }

    body.restored {
      background-color: var(--bg);
    }

    .terminal-font {
      font-family: 'Fira+Code', monospace;
    }

    #animated-bg {
      width: 100vw;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
      background: linear-gradient(125deg, #000000, #0a0a1a, #000000, #0a1a0a);
      background-size: 400% 400%;
      animation: gradientAnimation 20s ease infinite;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }

    body.light #animated-bg {
      background: linear-gradient(125deg, #ffffff, #f0f5ff, #ffffff, #f0fff0);
    }

    body.restored #animated-bg {
      opacity: 1;
    }

    @keyframes gradientAnimation {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    #main-content::-webkit-scrollbar {
      width: 8px;
    }

    #main-content::-webkit-scrollbar-track {
      background: transparent;
    }

    #main-content::-webkit-scrollbar-thumb {
      background-color: var(--border);
      border-radius: 4px;
    }

    .frosted-glass {
      background-color: var(--bg-secondary-translucent);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--border);
    }

    .command-bar-container {
      background-color: var(--bg-secondary-opaque);
      border: 1px solid var(--border);
      transition: all 0.2s ease;
    }

    .command-bar-container:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent), 0 0 20px 5px var(--accent-glow);
    }

    #command-input {
      color: var(--text-primary);
    }

    #command-input::placeholder {
      color: var(--text-secondary);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }

    /* Chat Agent Chip Styles */
    #chat-agent-container {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 50;
    }

    #chat-chip {
      transform-origin: bottom right;
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    @keyframes pulse-green {

      0%,
      100% {
        box-shadow: 0 0 0 0 rgba(63, 185, 80, 0.7);
      }

      70% {
        box-shadow: 0 0 0 10px rgba(63, 185, 80, 0);
      }
    }

    .agent-avatar-dot {
      animation: pulse-green 2s infinite;
    }
  </style>
</head>

<body class="w-full h-screen overflow-hidden flex flex-col">

  <div id="animated-bg"></div>

  <!-- Top Bar (Now always visible) -->
  <header id="top-bar" class="w-full fixed top-0 left-0 p-4 z-10 frosted-glass">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
      <div class="flex items-center gap-2 cursor-pointer" onclick="runCommand('home')">
        <svg viewBox="0 0 100 100" class="w-6 h-6">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#3fb950" />
              <stop offset="100%" stop-color="#0070f3" />
            </linearGradient>
          </defs>
          <path d="M 20,50 L 35,35 L 50,50 L 35,65 Z M 50,50 L 65,35 L 80,50 L 65,65 Z" fill="url(#g)" />
        </svg>
        <span class="font-bold text-lg text-[var(--text-primary)]">Kursion</span>
      </div>
      <nav class="hidden md:flex items-center gap-6 text-sm text-[var(--text-secondary)]">
        <a href="#" class="hover:text-[var(--text-primary)]"
          onclick="event.preventDefault();runCommand('about')">About</a>
        <a href="#" class="hover:text-[var(--text-primary)]"
          onclick="event.preventDefault();runCommand('services')">Services</a>
        <a href="#" class="hover:text-[var(--text-primary)]"
          onclick="event.preventDefault();runCommand('portfolio')">Portfolio</a>
        <a href="#" class="hover:text-[var(--text-primary)]"
          onclick="event.preventDefault();runCommand('contact')">Contact</a>
      </nav>
    </div>
  </header>

  <!-- Main Container -->
  <div id="main-container" class="flex-grow flex flex-col pt-24 pb-8 px-4 w-full">
    <!-- Command Bar -->
    <div id="command-bar" class="w-full max-w-2xl mx-auto mb-8 relative z-20 opacity-0 transition-opacity duration-500">
      <div class="command-bar-container rounded-lg flex items-center p-1">
        <svg id="command-icon" class="w-5 h-5 text-[var(--text-secondary)] mx-3" fill="none" stroke="currentColor"
          viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8 9l4-4 4 4m0 6l-4 4-4-4"></path>
        </svg>
        <input type="text" id="command-input" class="w-full bg-transparent text-lg p-2 outline-none"
          placeholder="Type a command...">
      </div>
    </div>
    <!-- Main Content Display -->
    <main id="main-content" class="flex-grow w-full overflow-y-auto"></main>
  </div>

  <!-- Chat Agent -->
  <div id="chat-agent-container" class="hidden">
    <div id="chat-chip"
      class="flex items-center gap-3 bg-[var(--bg-secondary-opaque)] border border-[var(--border)] text-[var(--text-primary)] p-3 rounded-lg shadow-xl max-w-sm transform scale-0 opacity-0">
      <div class="w-3 h-3 bg-[var(--brand-green)] rounded-full flex-shrink-0 agent-avatar-dot"></div>
      <p id="chat-text" class="text-sm"></p>
    </div>
  </div>


  <script>
    const commandInput = document.getElementById('command-input');
    const mainContent = document.getElementById('main-content');
    const topBar = document.getElementById('top-bar');
    const commandBar = document.getElementById('command-bar');
    const mainContainer = document.getElementById('main-container');
    const chatContainer = document.getElementById('chat-agent-container');
    const chatChip = document.getElementById('chat-chip');
    const chatText = document.getElementById('chat-text');

    let commandHistory = [];
    let systemState = {restored: false};

    const initialContent = {
      'crash': `<div class="w-full h-full flex items-center justify-center text-center"><div class="terminal-font"><h1 class="text-2xl font-bold text-[var(--text-primary)]">500 Internal Server Error</h1><p class="text-[var(--text-secondary)] mt-2">The server encountered an internal error and was unable to complete your request.</p></div></div>`,
      'restore_sequence': `
                <div class="max-w-3xl mx-auto terminal-font text-lg p-4 text-left">
                    <p>&gt; Executing <span class="text-[var(--brand-green)]">kursion init</span>...</p>
                    <p id="restore-step-1" class="opacity-0 transition-opacity duration-500">&gt; Bypassing server handshake... <span class="text-[var(--brand-green)]">OK</span></p>
                    <p id="restore-step-2" class="opacity-0 transition-opacity duration-500">&gt; Initializing client-side render engine... <span class="text-[var(--brand-green)]">OK</span></p>
                    <p id="restore-step-3" class="opacity-0 transition-opacity duration-500">&gt; Syncing content delivery network... <span class="text-[var(--brand-green)]">OK</span></p>
                    <p id="restore-step-4" class="opacity-0 transition-opacity duration-500">&gt; Loading animation subsystems... <span class="text-[var(--brand-green)]">OK</span></p>
                    <p id="restore-step-5" class="opacity-0 transition-opacity duration-500 font-bold text-white">&gt; System Restore Complete.</p>
                </div>`,
      'welcome': `<div class="flex flex-col items-center justify-center h-full text-center"><h1 class="text-5xl md:text-7xl font-bold mt-4 bg-clip-text text-transparent" style="background-image: linear-gradient(to right, var(--text-primary), var(--text-secondary));">Code is Craft.</h1><p class="mt-4 text-lg max-w-2xl" style="color: var(--text-secondary)">We don't just build, we architect. We don't just code, we create.</p><div class="mt-8 flex flex-wrap justify-center gap-3"><button class="frosted-glass py-2 px-4 rounded-lg hover:border-[#444] text-[var(--text-primary)]" onclick="runCommand('portfolio')">Explore Our Work</button></div></div>`,
    };

    const visualContent = { /* Populated in window.onload */};
    const commands = { /* Populated in window.onload */};

    const updateMainContent = (content, isRaw = false) => {
      mainContent.innerHTML = isRaw ? content : `<div class="fade-in max-w-5xl mx-auto p-4">${visualContent[content] || initialContent[content]}</div>`;
      mainContent.scrollTop = 0;
    };

    const showChatAgentMessage = (message, duration = 0) => {
      chatContainer.classList.remove('hidden');
      chatText.textContent = message;
      setTimeout(() => {
        chatChip.classList.remove('scale-0', 'opacity-0');
      }, 100);

      if (duration > 0) {
        setTimeout(hideChatAgent, duration);
      }
    };

    const hideChatAgent = () => {
      chatChip.classList.add('scale-0', 'opacity-0');
      setTimeout(() => chatContainer.classList.add('hidden'), 300);
    }

    const runCommand = (cmd) => {
      commandInput.value = cmd;
      executeCommand(cmd);
    };

    const executeCommand = (cmd) => {
      cmd = cmd.toLowerCase().trim();
      if (!cmd) return;

      if (!systemState.restored) {
        if (cmd === 'kursion init') {
          commandInput.value = '';
          handleRecovery();
        }
        return;
      }

      if (commandHistory[0] !== cmd) commandHistory.unshift(cmd);

      if (commands[cmd]) {
        if (cmd === 'theme') document.body.classList.toggle('light');
        else updateMainContent(cmd);
      } else if (cmd === 'clear' || cmd === 'home') {
        updateMainContent('welcome');
      } else {
        updateMainContent('help');
      }

      commandInput.value = '';
    };

    const handleRecovery = () => {
      hideChatAgent();
      commandBar.classList.add('opacity-0');
      mainContent.classList.add('opacity-0');

      setTimeout(() => {
        document.body.classList.add('restored');
        document.title = 'Kursion :: Tech Consultancy';
        updateMainContent('restore_sequence', true);
        mainContent.classList.remove('opacity-0');

        let delay = 500;
        for (let i = 1; i <= 5; i++) {
          setTimeout(() => {
            const step = document.getElementById(`restore-step-${i}`);
            if (step) step.classList.remove('opacity-0');
          }, delay);
          delay += 400;
        }
        setTimeout(finalizeRestore, delay);
      }, 500);
    };

    const finalizeRestore = () => {
      systemState.restored = true;
      // The main container and top bar are already in their correct final state.
      commandInput.placeholder = 'Type a command or search...';
      commandBar.classList.remove('opacity-0');

      updateMainContent('welcome');
      showChatAgentMessage("You did it! System restored. Thanks for the help, engineer. Feel free to look around.", 5000);
    };

    const applyInitialTheme = () => {
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (!prefersDark) {
        document.body.classList.add('light');
      }
    };

    commandInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {e.preventDefault(); executeCommand(commandInput.value);}
    });

    window.onload = () => {
      applyInitialTheme();

      Object.assign(visualContent, {
        'help': `<h1 class="text-4xl font-bold text-[var(--text-primary)]">Available Commands</h1><div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4"><div class="frosted-glass p-4 rounded-lg"><code class="text-lg text-[var(--accent)]">about</code></div><div class="frosted-glass p-4 rounded-lg"><code class="text-lg text-[var(--accent)]">services</code></div><div class="frosted-glass p-4 rounded-lg"><code class="text-lg text-[var(--accent)]">portfolio</code></div><div class="frosted-glass p-4 rounded-lg"><code class="text-lg text-[var(--accent)]">contact</code></div></div>`,
        'about': `<h1 class="text-4xl font-bold text-[var(--text-primary)]">Our Philosophy</h1><div class="bento-grid mt-8"><div class="bento-item-1 frosted-glass p-6 rounded-lg"><h2 class="text-2xl font-bold">Code is Craft</h2><p class="mt-2 text-[var(--text-secondary)]">We believe that writing software is a craft, requiring artistry, foresight, and a dedication to quality.</p></div><div class="bento-item-2 frosted-glass p-6 rounded-lg"><h2 class="text-2xl font-bold">Deep Understanding</h2><p class="mt-2 text-[var(--text-secondary)]">We're captivated by challenges and love understanding systems from the bare metal to the UI.</p></div><div class="bento-item-3 frosted-glass p-6 rounded-lg"><h2 class="text-2xl font-bold">Your Vision, Amplified</h2><p class="mt-2 text-[var(--text-secondary)]">We partner with you to translate your vision into robust, scalable technology.</p></div></div>`,
        'services': `<h1 class="text-4xl font-bold text-[var(--text-primary)]">Our Expertise</h1><div class="mt-8 space-y-6"><div class="frosted-glass p-6 rounded-lg"><h2 class="text-2xl font-bold">Artificial Intelligence & ML</h2></div><div class="frosted-glass p-6 rounded-lg"><h2 class="text-2xl font-bold">Bespoke Software Engineering</h2></div><div class="frosted-glass p-6 rounded-lg"><h2 class="text-2xl font-bold">DevOps & Cloud Infrastructure</h2></div></div>`,
        'portfolio': `<h1 class="text-4xl font-bold text-[var(--text-primary)]">Our Work</h1><div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8"><a href="#" class="frosted-glass card-link p-6 rounded-lg block" onclick="event.preventDefault(); runCommand('portfolio -sentinel')"><h3 class="text-xl font-bold">Sentinel: AI Threat Detection</h3></a><a href="#" class="frosted-glass card-link p-6 rounded-lg block" onclick="event.preventDefault(); runCommand('portfolio -nexus')"><h3 class="text-xl font-bold">Nexus: Scalable E-Commerce</h3></a><a href="#" class="frosted-glass card-link p-6 rounded-lg block" onclick="event.preventDefault(); runCommand('portfolio -cascade')"><h3 class="text-xl font-bold">Cascade: Automated CI/CD</h3></a></div>`,
        'contact': `<h1 class="text-4xl font-bold text-[var(--text-primary)]">Contact Us</h1><div class="mt-8 frosted-glass p-8 rounded-lg max-w-lg mx-auto text-center"><p class="mt-4 text-2xl"><a href="mailto:hello@kursion.io" class="text-[var(--accent)] hover:underline">hello@kursion.io</a></p></div>`,
      });
      Object.assign(commands, {'help': {}, 'about': {}, 'services': {}, 'portfolio': {}, 'contact': {}, 'theme': {}});

      mainContainer.classList.remove('justify-center');
      updateMainContent('crash');
      setTimeout(() => {
        showChatAgentMessage("Psst... Looks like our devs broke the deployment. I can give you superuser access to fix it, but don't tell anyone. Try typing 'kursion init' and it should hopefully work.");
        commandBar.classList.remove('opacity-0');
        commandInput.focus();
      }, 2000);
    };
  </script>
</body>

</html>
